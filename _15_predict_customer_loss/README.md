# Прогнозирование оттока телеком компании


## Цели и задачи проекта

Оператор связи «Ниединогоразрыва.ком» хочет научиться прогнозировать отток клиентов. Если выяснится, что пользователь планирует уйти, ему будут предложены промокоды и специальные условия. Команда оператора собрала персональные данные о некоторых клиентах, информацию об их тарифах и договорах. 

## Данные

Данные состоят из файлов, полученных из разных источников:

- `contract_new.csv` — информация о договоре;
- `personal_new.csv` — персональные данные клиента;
- `internet_new.csv` — информация об интернет-услугах;
- `phone_new.csv` — информация об услугах телефонии.

Во всех файлах столбец `customerID` содержит код клиента.

Информация о договорах актуальна на 1 февраля 2020.

## Использованные библиотеки

- pandas
- matplotlib
- seaborn
- numpy
- phik
- sklearn (StandardScaler, train_test_split, roc_auc_score, SGDClassifier, GridSearchCV, cross_val_score, cross_val_score, accuracy_score, confusion_matrix, roc_curve, confusion_matrix, OneHotEncoder)
- lightgbm
- catboost

## Вывод

<u>Анализ данных показал:</u>
- Всего контрактов 7043
- Интернетом пользуются 5517 клиентов
- Телефонной линией пользуются 6361 клиент
- 85% клиентов не закрыли контракт на 1 февраля 2020
- 60% клиентов получают эллектронные счета на оплату
- Чаще клиенты оплачивают услуги электронным чеком
- Автоматической оплатой пользуется 40% клиентов
- В среднем в месяц один клиент тратит 60-70 у.е., при этом минимальный платеж 18,25 у.е., а максимальный 118 у.е.
- Основная часть клиентов платит в месяц 35 - 90 у.е. (50% клиентов)
- Еще 20% клиентов платят за услуги менее 30 у.е. в месяц
- Клиентов мужчин незначительно больше женщин
- Клиентов с опто волокном на 6% больше, чем с DSL
- Более 60% кдиентов предпочитают не ставить Онлайн защиту
- Клиентов, которые подключают резервное копирование на 6% меньше, тех, то не подключет
- То же соотношение клиентов у подключения защиты девайса (чаще не подключают)
- Более 60% не пользуется техподдержкой
- Стриминговыми услугами пользуются 50 на 50
- Клиентов с несколькими телефонными линиями почти поровну (тех у кого нет чуть больше)

<u>Графический анализ данных выявил:</u>

Клиенты, которые ушли, в сравнении с оставшимися:
- Чаще имели большой ежемесячный платеж
- В общем платили больше за весь контракт
- Чаще были женаты/замужем
- Меньше пользовались многоканальной телефоннией
- Чаще пользовались доп услугами (Резервное копирование, Защита устройства, Стриминговое ТВ и Кино), что скорее всего и увеличивало ежемесячный платеж и общую сумму контракта
- В рамках ежемесячного платежа ушедших клиентов видим смещение распределения и среднего значения в сторону большей суммы, по сравнению с теми, кто не ушел по всем видам контрактов.
- Смещение увеличивается с уменьшением длительности контракта
- Что касается общей суммы контракта, то видим, что при оплате по месячно ушедшие клиенты платят намного больше, на годовом контракте наблюбдаем паритет, данные двух-годовых контрактов показывают, что ушедшие клиенты заплатили меньше.
- Ушедшие клиенты меньше пользуются только телефоном и чаще обоими сервисами
- Ушедшие и оставшиеся клиенты в подавляющем большинстве используют контракты с обновременным подключением интернета и телефонии
- И если оставшиеся клиенты чаще выбирают месячные контракты, то у ушедших клиентов практически равное распределение между контрактами с разным периодом действия

<u>Корреляционный анализ</u>
- Есть зависимость количества подключенных сервисов от признака наличия подключения интернета, признаков подключенных интернет услуг, месячного и общего платежей
- Также месячный платеж зависит от наличия подключения телефона, интренета и доп услуг
- От гендера ничего не зависит

<u>Обучение моделей</u>
- Лучшая модель в даннном случае - `LGBMClassifier`
- Лучшее значение ROC-AUC = 0.903 на обучающих данных
- Лучшие гиперпараметры:
    - `learning_rate` = 0.4
    - `max_depth` = 2
    - `n_estimators` = 300

<u>Обучение лучшей модели</u>  
- Из трех моделей **CatBoostClassifier**, **LGBMClassifier**, **SGDClassifier** 
>наилучший результат показала модель `LGBMClassifier` с показателями `ROC-AUC=0.92` и `Accuracy=0.92`;  
- Из всех признаков самым важным оказался `Длительность контракта в днях`;
- Рядом с ней по важности `ежемесячная и общая сумма платежей`;
- Из матрицы ошибок видим, что модель одинаково предсказывает как положительные так и отрицательные значения целевого признака (есть небольшая разница в тысячных, которой можно принебречь), что говорит о том, что наша модель не чувствительна к дисбалансу классов