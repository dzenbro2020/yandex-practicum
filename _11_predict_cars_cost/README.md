# Построение модели определения стоимости автомобиля

## Цели и задачи проекта

Сервис по продаже автомобилей с пробегом «Не бит, не крашен» разрабатывает приложение, чтобы привлечь новых клиентов. В нём можно будет узнать рыночную стоимость своего автомобиля.

Постройте модель, которая умеет её определять. В вашем распоряжении данные о технических характеристиках, комплектации и ценах других автомобилей.
Критерии, которые важны заказчику:

- качество предсказания
- время обучения модели
- время предсказания модели

## Данные

Признаки

- DateCrawled — дата скачивания анкеты из базы
- VehicleType — тип автомобильного кузова
- RegistrationYear — год регистрации автомобиля
- Gearbox — тип коробки передач
- Power — мощность (л. с.)
- Model — модель автомобиля
- Kilometer — пробег (км)
- RegistrationMonth — месяц регистрации автомобиля
- FuelType — тип топлива
- Brand — марка автомобиля
- Repaired — была машина в ремонте или нет
- DateCreated — дата создания анкеты
- NumberOfPictures — количество фотографий автомобиля
- PostalCode — почтовый индекс владельца анкеты (пользователя)
- LastSeen — дата последней активности пользователя

Целевой признак
- Price — цена (евро)

## Использованные библиотеки

- pandas
- numpy
- warnings
- time
- lightgbm
- catboost
- sklearn (LinearRegression, Pipeline, cross_val_score, train_test_split, mean_squared_error, GridSearchCV, OrdinalEncoder, StandardScaler)

## Вывод

Анализ данных:
- из поля Price убрали 0 значения и цены менее 200 евро (неадекватные цены на автомобиль)
- из поля RegistrationYear удалены объекты с годом регистрации менее 1980 г. (неликвид) и более 2023 г.
- объекты с мощностью менее 60 л.с (мощность малолитражек) и более 400 л.с.(таких авто в данных очень мало и есть выбросы до 20000 л.с) так же исключены из расчета
- к признаках VehicleType, Model, FuelType, Gearbox,Repaired пропуски были за менены на категорию other (таких пропусков мало)
- были удалены неинформативные признаки: 
    - NumberOfPictures `Кол-во фото автомобиля`
    - DateCrawled `Дата скачивания анкеты из базы`
    - RegistrationMonth `Месяц регитсрации автомобиля`
    - DateCreated `Дата создания анкеты`
    - LastSeen `Дата последней активности клиента`

Обучение моделей:
- Модель `LinearRegression` (без градиентного бустинга) сильно уступает в качестве моделям с бустингом, превосходя в скорости обучения и предсказания.
- Наилучшее качество 1608 показала модель `LightGBMRegressor`
- Но так как заказчику также выжны скорость обучения и скорость предсказания модели, то по совокупности оценок лидером становится модель `CatBoostRegressor`, которая показывает качество наравне с `LightGBMRegressor`, но при этом в разы быстрее обучается и на порядок быстрее предсказывает. 